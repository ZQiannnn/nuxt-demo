webpackJsonp([27],{"/bPn":function(t,e,n){"use strict";var i=function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"house-pledge-parking"}},[e("ParkingLayout",{attrs:{terms:!0,propertyConsultantSource:this.getSalesResponse,apiType:"1",pledgeType:!0,binding:"true"===this.$route.query.binding}})],1)};i._withStripped=!0;var s={render:i,staticRenderFns:[]};e.a=s},BXFs:function(t,e,n){"use strict";var i=n("mPOZ"),s=n("iL7k"),o=!1;var a=function(t){o||n("tp7i")},r=n("VU/8")(i.a,s.a,!1,a,"data-v-62589c6e",null);r.options.__file="components\\house\\ParkingLayout.vue",e.a=r.exports},EG8Z:function(t,e,n){"use strict";var i=n("Dd8w"),s=n.n(i),o=n("//Fk"),a=n.n(o),r=n("BXFs"),l=n("NYxO");e.a={layout:"notabbar",middleware:"authorizationRequired",components:{ParkingLayout:r.a},fetch:function(t){var e=t.store,n=t.query;return a.a.all([e.dispatch("salesconsultant/querySalesConsultant",{projectId:n.id}),e.dispatch("house/queryHouseDetails",n.id)])},data:function(){return{}},computed:s()({},Object(l.mapGetters)({getSalesResponse:"salesconsultant/getSalesResponse",getHouseDetails:"house/getHouseDetails"})),methods:{}}},IxJk:function(t,e,n){"use strict";(function(t){n("NYxO");var i=n("NFYZ");e.a={name:"timesshop-propertyconsultant",props:{propertyConsultantSource:{type:Object,required:!0}},data:function(){return{showPropertyConsultant:!1,getDefaultSelectValue:"请选择",propertyConsultantSelected:null}},computed:{getSalesConsultantList:function(){return t.map(this.propertyConsultantSource.data,"salesName")}},mounted:function(){if(this.propertyConsultantSource&&this.propertyConsultantSource.data&&this.propertyConsultantSource.data.length){var t=i.a.randomNum(0,this.propertyConsultantSource.data.length-1),e=this.propertyConsultantSource.data[t];this.propertyConsultantSelected=e.salesName,this.$emit("receiveFromChild",e.salesId),this.$store.dispatch("salesconsultant/setTempSales",{salesName:e.salesName,salesId:e.salesId})}},methods:{propertyConsultantPickerOnConfirm:function(e,n){if(this.showPropertyConsultant=!this.showPropertyConsultant,this.propertyConsultantSelected!==e){var i=t.head(t.filter(this.propertyConsultantSource.data,{salesName:e})).salesId;this.propertyConsultantSelected=e,this.$emit("receiveFromChild",i),this.$store.dispatch("salesconsultant/setTempSales",{salesName:e,salesId:i})}}}}}).call(e,n("M4fF"))},U6qj:function(t,e,n){var i=n("wcS1");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);n("rjj0")("1a32421e",i,!1,{sourceMap:!1})},VLjt:function(t,e,n){"use strict";var i=n("IxJk"),s=n("X9gf"),o=n("VU/8")(i.a,s.a,!1,null,null,null);o.options.__file="components\\house\\PropertyConsultant.vue",e.a=o.exports},X9gf:function(t,e,n){"use strict";var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"property-consultant"}},[n("van-cell-group",[n("van-cell",{attrs:{title:"置业顾问","is-link":"",value:t.propertyConsultantSelected||t.getDefaultSelectValue+"置业顾问"},on:{click:function(e){t.showPropertyConsultant=!0}}})],1),n("van-popup",{attrs:{position:"bottom"},model:{value:t.showPropertyConsultant,callback:function(e){t.showPropertyConsultant=e},expression:"showPropertyConsultant"}},[n("van-picker",{attrs:{"show-toolbar":"",columns:t.getSalesConsultantList},on:{confirm:t.propertyConsultantPickerOnConfirm,cancel:function(e){t.showPropertyConsultant=!1}}})],1)],1)};i._withStripped=!0;var s={render:i,staticRenderFns:[]};e.a=s},iL7k:function(t,e,n){"use strict";var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"parking-layout"}},[n("van-nav-bar",{attrs:{"left-arrow":"",title:"选取车位",id:"navbar"},on:{"click-left":function(e){t.$router.back()}}}),n("van-cell-group",[n("van-cell",{attrs:{title:"选择楼栋","is-link":"",value:t.building.selected||t.getDefaultSelectValue},on:{click:function(e){t.building.show=!0}}})],1),n("van-popup",{attrs:{position:"bottom"},model:{value:t.building.show,callback:function(e){t.$set(t.building,"show",e)},expression:"building.show"}},[n("van-picker",{attrs:{"show-toolbar":"",columns:t.building.cols},on:{confirm:t.buildingPickerOnConfirm,cancel:function(e){t.building.show=!1}}})],1),n("van-cell-group",[n("van-cell",{attrs:{title:"选择楼层","is-link":"",value:t.floor.selected||t.getDefaultSelectValue},on:{click:function(e){t.floor.show=!0}}})],1),n("van-popup",{attrs:{position:"bottom"},model:{value:t.floor.show,callback:function(e){t.$set(t.floor,"show",e)},expression:"floor.show"}},[n("van-picker",{attrs:{"show-toolbar":"",columns:t.floor.cols},on:{confirm:t.floorPickerOnConfirm,cancel:function(e){t.floor.show=!1}}})],1),n("van-cell-group",[n("van-cell",{attrs:{title:"选择车位","is-link":"",value:t.parking.selected||t.getDefaultSelectValue},on:{click:function(e){t.parking.show=!0}}})],1),n("van-popup",{attrs:{position:"bottom"},model:{value:t.parking.show,callback:function(e){t.$set(t.parking,"show",e)},expression:"parking.show"}},[n("van-picker",{attrs:{"show-toolbar":"",columns:t.parking.cols},on:{confirm:t.parkingPickerOnConfirm,cancel:function(e){t.parking.show=!1}}})],1),n("div",{staticClass:"button-section confirm-buttons"},[n("van-button",{attrs:{type:"danger",size:"normal",block:""},on:{click:t.addParking}},[t._v("确定选择")])],1),n("div",{staticClass:"card-image"},[t.selectedImg?n("figure",{staticClass:"image"},[n("img",{attrs:{src:t.imgPrefix+t.selectedImg}})]):t._e(),n("div",{staticClass:"house-pickup-result"},[n("p",{staticClass:"title is-size-7"},[t._v("已选车位:")]),n("div",{staticClass:"columns is-mobile"},t._l(t.dreamParkingList,function(e,i){return n("div",{key:i,staticClass:"column is-one-third"},[n("span",{staticClass:"tag is-white is-radiusless"},[t._v("\n\t\t\t\t\t\t  "+t._s(e.title)+"\n\t\t\t\t\t\t\t"),n("button",{staticClass:"delete is-small is-danger",on:{click:function(n){t.removeDreamParking(e,i)}}})]),t.collectionType?t._e():n("p",{staticClass:"help has-text-centered"},[t._v("第"+t._s(t._f("changeNum")(i+1))+"意向")])])}))])]),t.terms&&t.hasBinding?n("PropertyConsultant",{attrs:{propertyConsultantSource:t.propertyConsultantSource},on:{receiveFromChild:t.receiveFromChild}}):t._e(),n("div",{staticClass:"button-section2 buttons"},[n("van-button",{class:{"full-width":t.binding},attrs:{type:"danger"},on:{click:t.goToNextStep}},[t._v("下一步")]),t.binding?t._e():n("van-button",{attrs:{type:"default",plain:""},on:{click:t.goToNextStep}},[t._v("跳过")])],1),n("van-popup",{staticClass:"confirm-popup",attrs:{"close-on-click-overlay":!1},model:{value:t.showConfirmPopup,callback:function(e){t.showConfirmPopup=e},expression:"showConfirmPopup"}},[n("div",{staticClass:"confirm-details"},[n("div",{staticClass:"confirm-title"},[n("h3",[t._v("车位收藏成功")])]),n("div",{staticClass:"confirm-content"},[t._v("\n                    您可以在我的-我的收藏-房源收藏中查看收藏的房源情况。\n                ")]),n("div",{staticClass:"button-section"},[n("van-button",{attrs:{block:"",type:"warning"},on:{click:t.makeConfirm}},[t._v("确定")])],1)])])],1)};i._withStripped=!0;var s={render:i,staticRenderFns:[]};e.a=s},mPOZ:function(t,e,n){"use strict";(function(t){var i=n("woOf"),s=n.n(i),o=n("Xxa5"),a=n.n(o),r=n("exGp"),l=n.n(r),u=n("Dd8w"),c=n.n(u),p=n("VLjt"),d=n("NYxO"),h=n("62+5"),m=n("IdIt");e.a={name:"timesshop-parkinglayout",components:{PropertyConsultant:p.a},props:{subscribeType:{type:Boolean,default:function(){return!1}},pledgeType:{type:Boolean,default:function(){return!1}},collectionType:{type:Boolean,default:function(){return!1}},transferType:{type:Boolean,default:function(){return!1}},terms:{type:Boolean,default:function(){return!1}},limit:{type:Number,default:function(){return 3}},apiType:{type:String,required:!0},propertyConsultantSource:{type:Object},originOrderId:{type:String,default:function(){return""}},binding:{type:Boolean,default:function(){return!1}}},data:function(){return{imgPrefix:"",SalesConsultantId:null,selectedImg:null,building:{selected:null,show:!1,cols:[],selectRoomId:null,isFetchBuilding:!1},floor:{selected:null,show:!1,cols:[]},parking:{selected:null,show:!1,cols:[]},showConfirmPopup:!1,dreamParkingList:[],tempDreamParkingList:[],getDefaultSelectValue:"请选择",iteamIds:[]}},computed:c()({},Object(d.mapGetters)({getListProjects:"projects/getListProjects",getHouseDetails:"house/getHouseDetails",getTempSubscribeSource:"tempSubscribe/getTempSubscribeSource",getTempPledgeSource:"tempPledge/getTempPledgeSource",isAuthentication:"authorization/isAuthentication",getTempSales:"salesconsultant/getTempSales",getTempPledgeRoomList:"tempPledge/getTempPledgeRoomList",getTempSubscribeRoomList:"tempSubscribe/getTempSubscribeRoomList"}),{hasBinding:function(){var t=this.$route.query.binding;return!(!t&&void 0!==t)}}),created:function(){var e=l()(a.a.mark(function e(){var n;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.subscribeType&&this.getTempSubscribeRoomList&&this.getTempSubscribeRoomList.length)){e.next=9;break}return this.building.selectRoomId=this.getTempSubscribeRoomList[0].apartmentId,this,e.next=5,h.a.getRequest(m.a.house.lotBuilding,{roomId:this.building.selectRoomId});case 5:"true"===(n=e.sent).success&&(n.data&&n.data.length?(this.building.cols=t.map(n.data,"bldName"),this.building.isFetchBuilding=!0):this.building.cols=t.map(t.filter(this.getHouseDetails.buildings,{fproductName:"车位"}),"bldName")),e.next=10;break;case 9:this.building.cols=t.map(t.filter(this.getHouseDetails.buildings,{fproductName:"车位"}),"bldName");case 10:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),methods:{receiveFromChild:function(t){this.SalesConsultantId=t},buildingPickerOnConfirm:function(e,n){var i=this,o=t.filter(this.getHouseDetails.buildings,{bldName:e});if(o&&o.length){var a=t.head(o),r=a.bldId,l=a.carportImage;s()(this.building,{show:!1,selected:e}),s()(this.$data,t.omit(this.$options.data(),["building","dreamParkingList"])),this.selectedImg=t.head(l),this.$toast.loading({mask:!1,duration:0,forbidClick:!0,message:"数据加载中..."});var u={projectId:this.$route.query.id,buildingId:r,type:this.apiType};this.subscribeType&&this.building.selectRoomId&&this.building.isFetchBuilding&&s()(u,{roomId:this.building.selectRoomId}),this.$store.dispatch("projects/getSalesStatus",u).then(function(){var e=i.getListProjects.data,n=e.floorList,s=e.roomList;i.floor.cols=n,i.parking.cols=t.map(t.filter(s,{salesStatus:"1"}),"name")}).catch(function(t){i.$toast(t)}).finally(function(){i.$toast.clear()})}},floorPickerOnConfirm:function(t,e){s()(this.floor,{show:!1,selected:t})},parkingPickerOnConfirm:function(t,e){s()(this.parking,{show:!1,selected:t})},goToNextStep:function(){var e=this,n=this.getTempSales.salesName;this.$route.query.binding;void 0!==n&&(this.SalesConsultantId=n);if(this.subscribeType&&"subscribe",this.pledgeType&&"pledge",this.transferType&&"transfer",(this.subscribeType||this.pledgeType)&&this.binding&&!this.dreamParkingList.length)return this.$toast("请先选择车位");if(this.pledgeType&&(!this.getTempPledgeRoomList||!this.getTempPledgeRoomList.length)&&!this.dreamParkingList.length)return this.$toast("请先选择车位");if(this.subscribeType&&(!this.getTempSubscribeRoomList||!this.getTempSubscribeRoomList.length)&&!this.dreamParkingList.length)return this.$toast("请先选择车位");if((this.subscribeType||this.pledgeType)&&null===this.SalesConsultantId)return this.$toast("请选择置业顾问");if(this.getTempSubscribeRoomList&&this.getTempSubscribeRoomList.length){var i=t.head(this.getTempSubscribeRoomList),s=i.buildingId,o=(i.apartmentId,t.head(t.filter(this.getHouseDetails.buildings,{bldId:s})).paymentMethod);if(!o||!o.length)return this.$toast("缺少付款方式，请联系管理员！")}this.collectionType?this.$store.dispatch("wishlist/multiWishlist",{typeId:"APARTMENT",iteamId:this.iteamIds}).then(function(){e.showConfirmPopup=!e.showConfirmPopup}).catch(function(t){e.$toast(t)}):this.subscribeType?this.$store.dispatch("tempSubscribe/setTempSubscribeParkingList",this.dreamParkingList).then(function(){e.goToAuthentication(e.$route.query.id,"subscribe",e.isAuthentication)}):this.transferType?this.$store.dispatch("tempSubscribe/setTempSubscribeParkingList",this.dreamParkingList).then(function(){e.goToAuthentication(e.$route.query.id,"transfer",e.isAuthentication)}):this.pledgeType&&this.$store.dispatch("tempPledge/setTempPledgeParkingList",this.dreamParkingList).then(function(){e.goToAuthentication(e.$route.query.id,"pledge",e.isAuthentication)})},makeConfirm:function(){this.showConfirmPopup=!this.showConfirmPopup,this.$router.push({name:"house-detail-id",params:{id:this.$route.query.id},query:{name:this.getHouseDetails.name}})},removeDreamParking:function(t,e){this.dreamParkingList.splice(e,1)},addParking:function(){var e=this.parking.selected;if(!e)return this.$toast("请先选择车位");if(this.dreamParkingList.length>=this.limit)return this.$toast("最多只能选择"+this.limit+"个意向车位");if(-1!==t.indexOf(this.dreamParkingList,e))return this.$toast("您已选择"+e+"车位");var n=this.getHouseDetails.buildings,i=this.getListProjects.data.roomList,s=t.head(t.filter(n,{bldName:this.building.selected})).bldId,o=t.head(t.filter(i,{name:e})),a=o.id,r=o.floor,l=o.unit;this.dreamParkingList.push({title:e,roomId:a,apartmentId:a,floor:r,unit:l,buildingId:s,originOrderId:this.originOrderId}),this.iteamIds.push(a)}}}}).call(e,n("M4fF"))},pzgo:function(t,e,n){(t.exports=n("FZ+f")(!1)).push([t.i,"\n#parking-layout .button-section2[data-v-62589c6e] {\n  margin-top: 4rem;\n  padding: 0.64rem 2rem;\n}\n#parking-layout .button-section2.buttons[data-v-62589c6e] {\n    -webkit-box-pack: justify !important;\n    -webkit-justify-content: space-between !important;\n            justify-content: space-between !important;\n}\n#parking-layout .button-section2.buttons button[data-v-62589c6e] {\n      width: 7.2rem;\n      margin: 0 0.4rem;\n}\n#parking-layout .button-section2.buttons button.full-width[data-v-62589c6e] {\n        width: 100%;\n}\n#parking-layout .button-section2.buttons button.van-button--default[data-v-62589c6e] {\n        border-color: #BA1C28;\n        color: #BA1C28;\n}\n#parking-layout .button-section[data-v-62589c6e]:not(.confirm-buttons) {\n  margin-top: 0.93333rem;\n}\n#parking-layout .button-section.confirm-buttons[data-v-62589c6e] {\n  margin: 1.33333rem 50PX;\n}\n#parking-layout .house-pickup-result[data-v-62589c6e] {\n  padding: 15PX;\n  background: #fff;\n}\n#parking-layout .house-pickup-result .title[data-v-62589c6e] {\n    margin-bottom: 0.4rem;\n}\n#parking-layout .house-pickup-result .columns[data-v-62589c6e] {\n    margin: 0;\n}\n#parking-layout .house-pickup-result .columns .column span.tag[data-v-62589c6e] {\n      position: relative;\n      border: 1PX solid #dadada;\n      width: 100%;\n      color: #525252;\n      font-size: 0.74667rem;\n}\n#parking-layout .house-pickup-result .columns .column span.tag button[data-v-62589c6e] {\n        position: absolute;\n        top: -6PX;\n        right: -2PX;\n        background: #ff6e6e;\n}\n#parking-layout .house-pickup-result .columns .column p[data-v-62589c6e] {\n      color: #b2b2b2;\n}\n#parking-layout .confirm-popup[data-v-62589c6e] {\n  width: 80%;\n}\n#parking-layout .confirm-popup .confirm-details[data-v-62589c6e] {\n    padding: 15PX;\n}\n#parking-layout .confirm-popup .confirm-details .confirm-title[data-v-62589c6e] {\n      font-size: 0.85333rem;\n      color: #525252;\n      padding: 15PX 0;\n      text-align: center;\n}\n#parking-layout .confirm-popup .confirm-details .confirm-content[data-v-62589c6e] {\n      color: #7A7A7A;\n      font-size: 0.74667rem;\n}\n#parking-layout .confirm-popup .confirm-details .button-section[data-v-62589c6e] {\n      margin-top: 2.13333rem;\n}\n#parking-layout .confirm-popup .confirm-details .button-section .van-button--warning[data-v-62589c6e] {\n        background-color: #BA1C28;\n        border-color: #BA1C28;\n}\n",""])},tp7i:function(t,e,n){var i=n("pzgo");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);n("rjj0")("432b6e3c",i,!1,{sourceMap:!1})},vfd0:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n("EG8Z"),s=n("/bPn"),o=!1;var a=function(t){o||n("U6qj")},r=n("VU/8")(i.a,s.a,!1,a,"data-v-8a7905a6",null);r.options.__file="pages\\house\\pledge\\parking\\index.vue",e.default=r.exports},wcS1:function(t,e,n){(t.exports=n("FZ+f")(!1)).push([t.i,"",""])}});